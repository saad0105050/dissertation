Blockchain technology is a distributed computing primitive 
for implementing a decentralized, immutable ledger; 
such a ledger has important applications ranging 
from cryptocurrency to governance, to industrial supply chain management, 
to power networks, and so on.

Recently, the Proof-of-Stake (PoS) blockchain technology 
has emerged as an alternative 
to the Proof-of-Work (PoW) technology. 
While the latter enjoys wide popularity, 
it consumes a vast amount of wasteful energy as well. 
The case in point is Bitcoin: its global energy consumption in 2019 
is on par with that of Israel and Ireland.
It is, therefore, 
worthwhile to investigate 
whether the PoS technology can be made as functional and secure 
as the PoS technology.

In this dissertation, 
we study 
the security properties of 
Nakamoto-style PoS blockchain protocols. 
Not only have these protocols been deployed  
by leading cryptocurrency companies, 
but they have also garnered a keen interest from 
cryptography, algorithms, and distributed computing communities. 


A distributed, immutable ledger must provide 
\emph{consistency} and \emph{bias resistance}. 
Here, consistency means that the records written in the ledger cannot be erased. 
The privilege of writing a record in the ledger is 
a rare commodity by design; 
a user becomes an eligible writer by winning a verifiable lottery. 
However, a malicious coalition of users may conspire to 
undermine the consistency of the ledger once they become writers. 
They can also conspire to bias the lottery process in their favor 
so that they are more likely to become writers in the future. 

The aim of this research is to understand how
Nakamoto-style PoS protocols can achieve both consistency and bias-resistance 
while facing formidable attacks on its integrity.
We approach this problem by developing a simple yet powerful modeling and analysis framework.
The contributions from our research have 
improved the state-of-the-art security guarantees for these protocols. 
As a consequence, protocol designers can select 
strong security parameters---orders of magnitude stronger than 
what previous research had suggested---without
making any dent to the performance. 

% If all honest scribes attempt to write a given data into the ledger then, within a stipulated period of time, 
% it indeed gets written; this is called \emph{liveness}. 
% If something is ever written in the ledger, it will remain there (i.e., become ``settled'') with overwhelming probability; 
% this is \emph{persistence}. 

% blockchains have many important theoretical and practical applications. 


% There are many important theoretical and practical applications of blockchains 
% in decentralized computing, including cryptocurrencies such as Bitcoin.
% Like any distributed computing paradigm, 
% a central goal of blockchains is to provide liveness and persistence 
% while simultaneously achieving 
% performance (e.g., how long to settle?), 
% scale (e.g., how many users?), and 
% security (e.g., how likely is an error?). 


\section{Background}\label{sec:background-intro}
% \InlineCases{
%   \item PoW \item PoS \item Consistency and Settlement
%   \item Epochs, slots
%   \item Leader election, honest majority
%   \item Probabilistic statements
%   \item Consistency problem; double spending attack
%   \item Informal k-CP
%   \item Importance of the consistency error bound

%   \item Abstraction
%   \item Honest majority assumptions

%   \item Beacons, nonce, aggregate
%   \item Grinding problem, grinding power
%   \item Ouroboros MPC, Praos beacon
% }


The aim of this dissertation 
is to develop new understanding 
of the consistency and bias-resistance properties of 
Nakamoto-style PoS blockchains. 
Below, we introduce some important related concepts.




\Paragraph{Immutable ledgers and the leader election lottery.}
The term \emph{blockchains} refers to a family of protocols and algorithms 
in distributed computing 
that can be used to implement an ``immutable ledger'' 
which maintains an ordered list of records; 
this is why it is called a ``chain'' and a new record is called a ``block.''
Users of this ledger can reach agreement without needing to trust each other. 
The holy grail of blockchain algorithms is to achieve a good balance between 
the performance, security, and the scale of deployment. 
Of these, the trade-off between the performance and security 
is \emph{the} most important issue for both protocol designers and the users.

An immutable ledger must guarantee both \emph{liveness} and \emph{persistence}.
If all honest scribes attempt to write a given data into the ledger then, within a stipulated period of time, 
it indeed gets written; this is called liveness. 
If something is ever written in the ledger, it will remain there (i.e., become ``settled'') with overwhelming probability; 
this is persistence. 

Record settlement takes place in a varying speed in 
different families of blockchain protocols.
In the \emph{eventual consensus} model, 
the record persistence happens over time: 
as time goes by and more and more records get written in the ledger, 
the earlier records become less and less likely to be erased. 


Since blockchain algorithms make it unnecessary 
for the participants to trust one another, 
it relies heavily on how one can prove any claims. 
For example, if a user attempt to write a record on the ledger, 
he should supply a proof that he has the privilege to write. 
These privileges are, by design, a rare commodity. 
In fact, 
at every round, 
every participant performs a lottery to determine 
whether he has this authority to write a record at any; 
if he wins, he becomes a \emph{leader} and he writes in the ledger. 


\Paragraph{Proof-of-Work vs. Proof-of-Stake lotteries.}
In blockchains in the \emph{Proof-of-Work} (PoW) paradigm, 
the lottery is computation-intensive and, 
therefore, a large PoW network (such as Bitcoin) consumes a gargantuan amount of energy.
In contrast, the \emph{Proof-of-Stake} (PoS) is a paradigm where 
the lottery does not incur the steep cost of heavy computation. 
If PoS blockchains can provide the same (or similar) level of 
functionality, security, performance, and scale as the PoW counterparts, 
PoS could be a viable alternative to PoW blockchains 
and may emerge as the right technology for an energy-efficient future.
% But there is a difficulty: 
% in the PoW model, 
% a lottery winner can write at most one record 
% but 
% in the PoS model, a dishonest lottery winner may write 
% multiple records with impunity. 


\Paragraph{Nakamoto-style PoS and the consistency problem.}
% This comes in contrast to the ``exact consensus'' model 
% where a record achieves persistence as soon as it is written. 
This dissertation focuses on \emph{Nakamoto-style PoS}; 
these are PoS blockchains in the eventual consensus model where the participants 
always adopt a maximum-length blockchain from their local views. 
Examples of Nakamoto-style PoS are Ouroboros~\cite{Ouroboros}, Praos~\cite{Praos}, 
Genesis~\cite{Genesis}, SnowWhite~\cite{SnowWhite}, 
and Sleepy Consensus~\cite{Sleepy}.
However, the honest players face some obstacles toward reaching consensus: 
dishonest players are \emph{Byzantine}, i.e., 
they can arbitrarily deviate from the protocol, 
often acting in concert, 
showing multiple longest chains to the honest players;
and honest players may experience network errors. 
If two honest players disagree about a record that was 
written more than $k$ rounds in the past;
this is called a \emph{$k$-consistency violation}. 
This $k$ is called the \emph{security parameter} of the protocol.
Since consistency is central to an eventual consensus protocol, 
any improvements in regards to the consistency implies 
improvements in many other areas of the protocol as well.


The lottery in the leader election implies that 
whether a leader is honest (or dishonest) is a probabilistic event, 
and the sequence of leaders during protocol execution 
influences the probability of a $k$-consistency violation.
The heart of a PoS security analysis is to argue that $k$-consistency violations are rare; 
concretely, this means the bad probability should decrease as we increase $k$. 



\Paragraph{Bias-resistant randomness beacons and the grinding problem.}
Conducting the leader election in an unbiased and verifiable way 
requires that the players have access to a common random string. 
However, as more and more elections are made, 
this string becomes less and less random, possibly introducing bias in the election. 
To mitigate this behavior, 
new common randomness is introduced in regular intervals; 
the process is called the \emph{randomness beacon}.

Specifically, the blockchain protocol execution is punctuated into \emph{epochs} of length $O(k)$; 
each epoch constitutes a predetermined number of rounds 
and, during an epoch, 
the players take part in a \emph{collective coin-flipping protocol} 
to compute the random string for the next epoch; 
this string is called the \emph{beacon output} for this epoch.
However, adversarial leaders can control (to some extent) 
which blockchain prefix becomes settled within an epoch and, 
if the beacon output depends on this prefix,  
they exert some control over the beacon output as well. 
As this output is used in the leader elections in the next epoch, 
a bias in the beacon output inflates the chance of a consistency violation. 
This is the so-called \emph{grinding attack} on the blockchain; 
the amount of inflation in the error probability is called the \emph{grinding power}.


\Paragraph{The interplay between consistency and bias-resistance.}
Although we should take a large $k$ to 
reduce the likelihood of a $k$-consistency error, but 
we cannot do so unilaterally. 
Increasing $k$ implies that the records 
would take longer to be declared ``settled'' 
and hence, it may not always be practical.
However, increasing $k$ 
increases the epoch length as well, 
executing the beacon protocol over longer periods of time and 
thereby increasing the strength of a grinding attack. 

Therefore, 
if we want to make the Nakamoto-style PoS blockchains to be 
both secure and fast, 
we need a tight bound on the $k$-consistency error probability
as well as 
a tight bound on the grinding power (as a function of $k$). 
Moreover, 
for the Nakamoto-style PoS technology  
to become a viable alternative to the PoW technology, 
we want these security bounds to be comparable (at least asymptotically) 
with the bounds in the PoW setting.


% \Paragraph{The longest-chain rule.}
% We study the behavior of the elementary \emph{longest-chain rule}
% algorithm, carried out by a collection of participants. 
% \begin{itemize}
%   \item In each round,
%   each participant collects all valid blockchains from the network; if a
%   participant is a leader in the round, he adds a block to the longest
%   chain and broadcasts the result.
% \end{itemize}




% A prevalent algorithm for eventual consensus blockchains 
% (in both PoW and PoS) is \emph{the longest-chain rule}.







\section{Research focus}\label{sec:intro-focus}
This dissertation is focused on the consistency problem and the grinding problem in 
eventual consensus PoS blockchains. 

\Paragraph{Consistency error bounds.}
In the previous section, 
we have pointed out how important a consistency bound is. 
Consider the $\kCP$ property.
The first ever PoS consistency bounds, 
put forth by~\citet{Ouroboros} and~\citet{SnowWhite}, 
had the form $e^{-\Omega(\sqrt{k})}$. \footnote{
  $\Omega(g(k))$ is the class of functions $f(k)$ 
  which, loosely speaking, 
  ``stay above $g(k)$'' for large inputs $k$.
  Similarly, $O(g(k))$ is the class of functions $f(k)$ 
  which, loosely speaking, 
  ``stay below $g(k)$'' for large inputs $k$.
}
However, the $\kCP$ error bound in the PoW setting is $e^{-\Omega(k)}$. 
Specifically, fix a positive integer $T$ and let $\varepsilon = e^{-\Omega(T)}$ 
be the desired settlement error. 
Then, settlement delay in the PoW would be $O(T)$ while 
the same in the PoS would be $O(T^2$. 
This quadratic gap in the settlement delays 
was deeply problematic since, 
at that time, 
the community did not know whether this gap 
was an inherent drawback of the PoS paradigm 
or whether it was an artifact of the analysis. 
Whatever it may be, 
it was an urgent question to close this gap. 

Furthermore, from a practitioner's point of view, 
having only an asymptotic bound on the consistency error is a good start, 
but it is not good enough; 
we need to be able to exactly compute the consistency errors 
(under various parameter regimes) 
so that we can have the vantage point of setting 
various system parameters. 
It is also important to communicate these values 
to the user community and investors 
so that they can make informed decisions.


\Paragraph{Slots with multiple honest leaders.}
Recall that the leader election mechanism is a 
critical component of any blockchain protocol. 
In particular, 
the security guarantees critically rely on the 
statistical properties of the elected leaders 
and, more precisely, 
whether a slot is ``dishonest'' or ``honest'' 
and, if honest, whether it has a single leader (\emph{uniquely honest}) 
or multiple leaders (\emph{multihonest}).
The existing analyses for PoS blockchains, 
as it turns out, 
put undue penalties on the event that a honest slot has multiple leaders. 
That is, although intuition tells us that this should be a ``good event'' for the analysis, 
in practice, it is treated as either an adversarial event~\cite{Ouroboros,Praos,Genesis} 
or, at best, a neutral event~\cite{SnowWhite,Sleepy}. 
Not only is this conservative modeling unintuitive, 
but it also hamstrings the consistency error bounds 
by effectively relinquishing honest stake. 
As you can imagine, this conservative approach leads to weak consistency bounds 
and, on top, it precludes a broad swath of leader election mechanisms 
where a multihonest slot is a frequent outcome.


\Paragraph{Grinding in Praos and SnowWhite.}
Recall that important PoS protocols, including deployed ones such as Praos, 
are susceptible to a grinding attack. 
Although this risk is mitigated in respective security analyses, 
this is done in a push-under-the-rug way. 
Specifically, both Praos and SnowWhite's consistency error bounds look like 
$\gamma e^{-\Omega(k)}$ where 
$\gamma$ is a stand-in for the maximum number of resets 
made to the beacon value in any epoch
(i.e., the grinding power). 
Note that when $\gamma$ is large, 
it can seriously weaken the consistency error bound. 
As you can imagine, this will have serious repercussions in all parts of the protocol design. 
However, there are no analysis of the grinding power in the literature. 
Thus, although we know that the consistency error bound is intertwined with 
the grinding power, we do not know how much.


% \Paragraph{Simple, secure beacons.} 
% Recall that Ouroboros precludes grinding 
% by employing a multi-party protocol which relies on heavy cryptography. 
% In contrast, Praos and SnowWhite use simple beacon protocols 
% but must withstand potential grinding. 
% Algorand~\cite{Algorand} uses a non-MPC beacon 
% but it is not an eventual consensus protocol 
% (it is an expected constant-time BFT protocol).









\section{Research objectives}\label{sec:intro-objectives}
The observations above can be congealed into the following objectives:

\newcounter{ConsistencyObjectives}
\begin{description}[font=\normalfont\itshape\space]
  \item[Consistency Problem:]~
  \begin{enumerate}
    \item Derive tight asymptotic consistency bounds for PoS blockchains, 
    treating multihonest slots as good events.

    \item Compute explicit settlement error probabilities.

    \setcounter{ConsistencyObjectives}{\value{enumi}}
  \end{enumerate}

  \item[Grinding Problem:]~
  \begin{enumerate}
    \setcounter{enumi}{\value{ConsistencyObjectives}}

    \item Quantify the grinding power in Praos and SnowWhite. 
    Specifically, characterize how $\gamma$ grows 
    as a function of the consistency parameter $k$ and the adversarial stake $\alpha$
    
    \item Propose and analyze new, simple, more secure beacons 
    whose grinding power grows at a much slower rate than that in Praos.
  \end{enumerate}
\end{description}





\section{The value of this research}
\InlineCases{
  \item Fast settlements
  \item Reduce wasted efforts
  \item Explicit probabilities
  \item Cardano
  \item Quantify grinding in deployed protocols
  \item Trade-off between consistency and grinding
  \item New simple beacons
}


This research adds some compelling value to the extant scientific knowledge. 

For the first time in the literature, 
this work shows that 
PoS blockchains can achieve the same asymptotic dependence on $k$ 
as in the PoW setting; namely, we improve the state-of-the-art bound 
from $e^{-\Omega(\sqrt{k})}$ to $e^{-\Omega(k)}$~\cite{LinearConsistencySODA}. 
As discussed before, this immediately implies that 
PoS blockchains settle much faster than what we thought before. 
Thus, deployed protocols can safely select stronger security parameters. 
We also provide algorithms and software tools 
for practitioners to explicitly compute consistency error probabilities. 
A leading PoS cryptocurrency technology company, \emph{Cardano}~\cite{Cardano}, 
is actively using the results and recommendation from this dissertation.

In addition, our results in the ``simple honest stake majority'' setting~\cite{Multihonest}. 
This readily improves the guarantees of several existing analyses, 
namely Praos, Genesis, and SnowWhite. 
These results allow for leader election schemes 
for which a uniquely honest slot, on average, is less likely than 
an adversarial slot. 
No previous analysis can handle this parameter regime.
We also introduce new combinatorial notions which 
greatly simplifies consistency proofs.
Moreover, this work establishes connections between 
combinatorial notions and ideas from two 
different schools of PoS analysis.

Shifting focus to PoS beacons, 
our analysis of the Praos beacon is a first in the literature.
Importantly, we characterize the growth of the grinding power 
by studying its first two moments. 
Our results show that when the adversarial stake ratio is below $9\%$, 
this grinding power is, in fact, $\Poly(k, \alpha)$. 
On the flip side, this means the quality of the beacon degrades fast 
as the adversarial stake ratio increases beyond $9\%$. 

Thus, we need more secure yet simple PoS beacons. 
The current work delivers in this front by 
analyzing two new beacons. 
The first one works with a Praos-like private leader election; 
it is secure for $\alpha \leq 0.41$. 
The second one works with Ouroboros-like public leader election 
and it is secure for as long as $\alpha \in (0, 1/2)$. 


\Paragraph{Some insights and highlights from this dissertation.}
\begin{enumerate}
  \item Longest-chain PoS protocols have the same asymptotic 
  consistency error bounds, namely $e^{-\Omega(k)}$. 
  The constants hidden by the $\Omega$ notation differs, though: 
  let $\epsilon \in (0,1)$ so that 
  the adversarial stake is $\alpha = (1-\epsilon)/2$. 
  Then longest-chain PoW incurs a $\kCP$ violation with probability $e^{-\Omega(\epsilon^2)k}$, 
  whereas the error probability for longest-chain PoS is $e^{-\Omega(\epsilon^3)k}$.

  \item There is a program to explicitly compute these probabilities.

  \item Longest-chain PoS can operate securely as long as on average, an honest slot 
  (i.e., the said slot is associated with only honest leaders) 
  is more likely than an adversarial slot.

  \item For longest-chain PoS blockchains, 
  there is an optimal adversarial strategy 
  which can produce an execution 
  where all slots are \emph{maximally unsettled}, meaning that 
  if it is possible to unsettle a slot -- any slot -- 
  this adversary \emph{will} unsettle this slot. 
  We prove our security against this adversary.

  \item If we are willing to adopt a \emph{consistent} 
  longest-chain tie-breaking rule (see Section~\ref{sec:lcr-model}), 
  we can allow $\Pr[\text{uniquely honest slot}] = 0$ 
  and still remain secure.

  \item The consistency guarantee for Praos is valid 
  as long as the adversarial stake $\alpha < 0.0955$; 
  in that regime, the grinding power is $\Poly(k)$ 
  where $k$ comes from the $\kCP$ property of Praos. 
  Beyond that, the grinding power of the adversary grows exponentially in $k$.

  \item There are simple beacon protocols 
  whose grinding power grows at a much slower rate than that of Praos.
\end{enumerate}




\section{Outline of this dissertation}
To do







