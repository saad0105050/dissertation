%===========================================================
% \subsection{Stirling's approximation and binomial coefficients}
Let us briefly recall an upper bound on binomial coefficients.

\begin{theorem}[Stirling's approximation]
For any positive integer $n$,
\[
n! \, = \, \sqrt{2\pi n}(\frac{n}{e})^n e^{r(n)}\, ,
\]where
\[
\frac{1}{12n} < r(n) < \frac{1}{12n + 1}.
\]
\end{theorem}

Let the binary entropy function $H : [0, 1] \rightarrow [0, 1]$ be defined as
\begin{align*}
H(\alpha) & \defeq \left\{ \begin{array}{ll}0 & \text{ if } \alpha \in \{0, 1\}\\
\\
-\alpha \log_2(\alpha) - (1-\alpha) \log_2(1-\alpha) & \text{ if } \alpha \in (0, 1)\end{array} \right. .
\end{align*}

\begin{corollary}\label{coro:nchoosek_1}
For a positive integer $n$ and any $\alpha \in \{\frac{1}{n}, \frac{2}{n}, \cdots, \frac{1}{2} \}$, 
\begin{align}\label{eq:nck}
  \frac{2^{n H(\alpha)}}{\sqrt{8 n\alpha (1-\alpha)}} 
  \leq {n \choose \alpha n} 
  \leq \frac{2^{n H(\alpha)}}{\sqrt{\pi n\alpha (1-\alpha)}} 
  \leq \frac{2^{n H(\alpha)}}{\sqrt{\pi/2}} \, .
\end{align}
\end{corollary}

\begin{proof}
\begin{align*}
{n \choose \alpha n}
&= \frac{n!}{(\alpha n)!\, \left( (1-\alpha)n \right)! }\\
&\approx \frac{\sqrt{2\pi n}(\frac{n}{e})^n}{2\pi n\sqrt{\alpha (1-\alpha)}(\frac{\alpha n}{e})^{\alpha n}(\frac{(1-\alpha)n}{e})^{(1-\alpha)n} } \underbrace{ \exp\left( \frac{1}{12n} - \frac{1}{12\alpha n + 1} - \frac{1}{12(1-\alpha)n+1}\right) }_{ E(n,\alpha) } \\
&= 2^{n H(\alpha)} \, 1/\underbrace{ \sqrt{2 \pi n\alpha (1-\alpha)} }_{F(n, \alpha)} \, E(n, \alpha) \\
&=2^{n H(\alpha)} E(n, \alpha)/F(n, \alpha) \, .
\end{align*}

\emph{(The upper bounds.)} $E(n,\alpha)$ is at most $e^{1/12 n} < \sqrt{2}$. Hence the first (tighter) upper bound follows. Now we deal with the quantity $F(n, \alpha)/\sqrt{2} = \sqrt{\pi n \alpha (1-\alpha)}$. Since $1-\alpha \geq 1/2$ and $\alpha \geq 1/n$, we have this is at least $ \sqrt{\pi/2}$. \emph{(The lower bound.)} $E(n, \alpha)$ is at least $1$, and $2\pi$ is at most $8$. Hence the bound follows.

\end{proof}

\begin{corollary}\label{coro:nchoosek_2}
For a positive integer $n$ and any $\alpha \in [\frac{1}{n},\frac{1}{2} - \frac{1}{n}]$, 
\begin{align}\label{eq:nck_2}
{(1-\alpha)n \choose \alpha n} \leq 2^{(1-\alpha)n\,H\left( \frac{\alpha}{1-\alpha} \right)}\, G(n, \alpha)\,,
\end{align}
where \[
 G(n,\alpha) \leq \sqrt{\frac{1-\alpha}{\alpha(1-2\alpha) \pi n} } \leq \sqrt{\frac{1-\alpha}{ 2 \pi \alpha} } \leq \sqrt{ \frac{n-1}{2 \pi} }\, . 
 \]
\end{corollary}
\begin{proof}

\begin{align*}
{(1-\alpha)n \choose \alpha n}
&= \frac{((1-\alpha)n)!}{(\alpha n)!\, \left( (1-2\alpha)n \right)! }\\
&\approx \frac{\sqrt{2\pi (1-\alpha)n}(\frac{(1-\alpha)n}{e})^{(1-\alpha)n}}{2\pi n\sqrt{\alpha (1-2\alpha)}(\frac{\alpha n}{e})^{\alpha n}(\frac{(1-2\alpha)n}{e})^{(1-2\alpha)n} } \\
&\qquad \cdot \underbrace{ \exp\left( \frac{1}{12(1-\alpha)n} - \frac{1}{12\alpha n + 1} - \frac{1}{12(1-2\alpha)n+1}\right) }_{E(n,\alpha)}  \\
&= \underbrace{ \sqrt{\frac{1-\alpha}{\alpha(1-2\alpha) 2 \pi n} } }_{F(n, \alpha)}\, \left( \frac{(1-\alpha)^{1-\alpha}}{\alpha^\alpha (1-2\alpha)^{1-2\alpha}} \right)^n\, E(n, \alpha)\\
&=F(n, \alpha) \, 2^{(1-\alpha)n\,H\left( \frac{\alpha}{1-\alpha} \right)} \, E(n, \alpha)\, .
\end{align*}

First, note that $\alpha \leq 1/2 - 1/n$ implies $(1-2\alpha)n \geq 2$. Consequently, $F(n, \alpha) \leq \sqrt{\frac{1-\alpha}{ 4 \pi \alpha} }$. Moreover, $E(n,\alpha)$ is at most $e^{1/12(1-\alpha)n} < \sqrt{2}$. This gives $F(n, \alpha)E(n, \alpha) \leq \sqrt{\frac{1-\alpha}{ 2 \pi \alpha} }$. Since $\alpha \geq 1/n$, the quantity inside the square root is at most $(1-1/n)/2 \pi(1/n) = (n-1)/2\pi$.

\end{proof}
