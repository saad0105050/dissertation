\section{Beacon output after a single epoch}
Let $\epsilon \in (0,1)$ and $\alpha = (1-\epsilon)/2$ be the adversarial stake.
Suppose that $\Blockchain$ is $(\EpsP, k, s)$-secure in an epoch 
where first $n$ slots, 
which correspond to a characteristic string $W \sim \mathcal{L}_n(\alpha)$, 
contribute to the beacon output.
Recall $g(n,\epsilon)$ defined in ~\eqref{eq:praos-gneps}.
Using Lemma~\ref{lemma:grinding-praos-second-moment} and~\ref{lemma:praos-tail-gamma}, 
we can see that except with probability $2\EpsP$, $g(n,\epsilon)$ is at most $\sqrt{m/\EpsP}$ 
where $m$ is the right-hand-side of~\eqref{eq:grinding-praos-second-moment}.


\section{Beacon output after $L$ epochs}\label{sec:thm-praos-multiepoch}\label{sec:proof-praos-theorem}
% \section{Beacon output after $L$ epochs; Proof of Theorem~\ref{thm:minentropy-loss-praos}}\label{sec:proof-praos-theorem}



\begin{theorem}[Praos beacon over multiple epochs]\label{thm:minentropy-loss-praos}  
  Let $\alpha \in (0, 1/2)$. 
  Suppose Praos 
  remains $(\EpsP, k, s)$-secure 
  inside any epoch 
  whose characteristic string is sampled 
  according to the distribution $\mathcal{L}(\alpha)$.
  Let $\rho$ be the min-entropy loss in 
  the beacon output after $L$ epochs. 
  \begin{itemize}
    \item If $\alpha \leq 0.095$ then 
    $\rho \leq 1/2 \cdot \log_2(1/\EpsP) + \log_2(s) + 0.14 - \alpha$ 
    except with probability $L \cdot (2 \EpsP + s \sqrt{\EpsP} )$.

    \item Otherwise, there is a positive constant $c = c(\alpha, s)$ so that 
    $\rho \leq 1/2 \cdot \log_2(1/\EpsP) 
    + c \alpha s
    % + s/2 \cdot \log_2(1+3\alpha)
    $ 
    except with probability $L \cdot (2 \EpsP + (1.1 - 0.8 \alpha) s (1+3\alpha)^s \sqrt{\EpsP} )$. 
    We can take $c = 3$ for $\alpha \geq 1/3$ and $s \geq 4$.
  \end{itemize}
\end{theorem}

The proof of Theorem~\ref{thm:minentropy-loss-praos} 
is presented in Section~\ref{sec:proof-praos-theorem}. 

\begin{remark*}
  If $0.095 < \alpha < 1/3$, we can obtain tighter upper bounds on both $\ell$ and the bad probability 
  by using relevant upper bounds from~\eqref{eq:grinding-praos-second-moment} 
  in the proof of Theorem~\ref{thm:minentropy-loss-praos}. 
  The $\log_2(1/\EpsP)$ term in the min-entropy loss $\ell$ 
  is inevitable if we want 
  the bad probability to be at most $\EpsP^\delta$ 
  for some positive real constant $\delta \in (0, 1)$. 
  The factor $1/2$ in front of the $\log_2(1/\EpsP)$ term 
  is an artifact of the tail bound using the second-moment method.
  Finally, when $\alpha \geq 0.1$, 
  both the number of adversarial resets $R_L$
  and the bad probability 
  grow exponentially in $s$.
\end{remark*}


\subsection{Proof of Theorem~\ref{thm:minentropy-loss-praos}}

Let $W \sim \mathcal{L}_n(\alpha)$. 
Let $E_p$ be the event that 
$\Blockchain$ is not $(\EpsP, k, s)$-secure during 
the first $n$ slots in an epoch. 
Let $M$ be an upper bound on the second moment of $g$, 
conditioned on $\overline{E}$. 
Let $\gamma \geq (M/\EpsP)^{1/2}$. 
Let $E_g$ be the event that $g(W)$ is more than $\gamma$.
By Lemma~\ref{lemma:grinding-praos-second-moment}, 
$\Pr[g(W) \geq \gamma] \leq 2 \EpsP$. 
Note that the min-entropy loss in the beacon is at most 
\begin{equation}\label{eq:log-gamma}
 \log_2(\gamma) 
 = 1/2 \cdot [\log_2(M) + \log_2(1/\EpsP)]
 = \log_2(\sqrt{M}) + \log_2(1/\sqrt{\EpsP})
 \,. 
\end{equation}


Condition on the event that neither $E_p$ nor $E_g$ 
occurs during the first $L$ epochs. 
This means, in any of the $L$ epochs, 
the adversary can inflate the failure probability 
by at most a factor of $\gamma$.
The total bad probability after $L$ epochs is
$$
  p
  \leq L (2 \EpsP + \gamma \EpsP)
  = L (2 \EpsP + M^{1/2} \sqrt{\EpsP})
  \,.
$$

Considering~\eqref{eq:grindign-praos-second-moment}, 
let $f(\alpha) = 0.4 (1 + 2\epsilon)$. 
Observe that 
\begin{align*}
  &f(\alpha)^{1/2} \leq 1.1 - 0.8 \alpha\,,
  \quad\text{and}\\
  &\log_2 (f(\alpha)^{1/2}) \leq 
  0.14 - \alpha
  % \begin{cases}
  %   0.14 - \alpha & \text{if $\alpha \leq 0.095$}\,,\\
  %   0.25 - 1.6\alpha & \text{if $\alpha \in (0.095, 1/2)$}\,.
  % \end{cases}
  \,.  
\end{align*}
This is because $0.4 (1+2\epsilon) 
= 0.4 (3 - 4\alpha) 
= 1.2 (1 - 4\alpha/3) 
\leq 1.2 e^{-4\alpha/3}$ 
since $1 + x \leq e^x$ for any real $x$. 
The square root of the above quantity, which is $\sqrt{1.2} e^{-2\alpha/3}$, 
is bounded from above by the linear function 
$1.1 - 0.8 \alpha$ for $\alpha \in [0,  1/2)$. 
On the other hand, 
$\log_2 (f(\alpha)^{1/2})
\leq \log_2 \sqrt{1.2} + \log_2(e^{-2\alpha/3})
\leq 0.132 + (-2\alpha/3)/\ln(2)
\leq  0.14 - \alpha
$
for $\alpha \in [0, 1/2)$. 
% Furthermore, when $\alpha \in (0.095, 1/2)$, 
% it can be checked that 
% $\log_2 \sqrt{f(\alpha)}$ is at most $0.25 - 1.6\alpha$.

\paragraph{If $\alpha \leq 0.095$:} 
In this case, $M \leq s^2 f(\alpha)$ 
and, therefore, $M^{1/2}$ is at most $s (1.1 - 0.8 \alpha)$.
It follows that $p = L (\EpsP + s (1.1 - 0.8 \alpha) \sqrt{\EpsP})$
and 
$
\log_2 \sqrt{M}
\leq \log_2 s + 0.14 - \alpha
$.
Consequently, the min-entropy loss in the beacon is at most 
$$
  \log_2(\gamma) 
  = \log_2 \sqrt{M} + \log_2(1/\sqrt{\EpsP}) 
  = \log_2(s) + \log_2(1/\sqrt{\EpsP})  
    + 0.14 - \alpha
    \,.
$$




\paragraph{If $\alpha > 0.095$:} 
In this case, using~\eqref{eq:grindign-praos-second-moment}, 
we can take 
% $M = s^2 \cdot 0.4(1 + 2\epsilon) \cdot (1+3\alpha)^s)$ 
$M = s^2 f(\alpha) \cdot ((5 - 3\epsilon)/2)^s$ 
since 
the right-hand side of~\eqref{eq:grindign-praos-second-moment} is dominated by the function in the top condition. 
(This is also the most relevant case since 
when $\alpha$ is large, $\epsilon$ is small.)
Since 
$(5-3\epsilon)/2 = 1 + 3\alpha$, 
we have 
$M = s^2 f(\alpha) \cdot (1+3\alpha)^s$, 
$M^{1/2} \leq s (1.1 - 0.8 \alpha) (1+3\alpha)^{s/2}$, 
and $\log_2 \sqrt{M} \leq \log_2(s) + (0.14 - \alpha) + (s/2) \log_2(1+3\alpha)$. 
For a fixed $\alpha$, 
$\log_2 \sqrt{M}$ is dominated by the term $(s/2) \log_2(1+3\alpha)$. 
Note that for any real $\alpha$, $\log_2(1+3 \alpha)$ is at most $3\alpha/\ln(2)$.
We can check that $\log_2(s) + (0.14 - \alpha) + (s/2) \log_2(1+3\alpha)$ is at most $3 \alpha s$ for $s \geq 4$ and $\alpha \geq 1/3$.
% In particular, $\log_2 \sqrt{M} \leq (s/2) \log_2(1+3\alpha)$. 

It follows that 
$p \leq L (2 \EpsP + (1.1 - 0.8 \alpha) s (1+3\alpha)^{s/2} \sqrt{\EpsP} )$ 
and 
the min-entropy loss in the beacon is at most 
$
  \log_2(\gamma) 
  = \log_2 \sqrt{M} + \log_2(1/\sqrt{\EpsP})
  % = \log_2(s) + (0.14 - \alpha) + (s/2) \log_2(1+3\alpha) + 1/2 \cdot \log_2(1/\EpsP)
  % \leq s/2 \cdot \log_2(1+3\alpha) + \log_2(1/\sqrt{\EpsP})
  \leq 3 \alpha s + \log_2(1/\sqrt{\EpsP}) 
$ 
for $\alpha \geq 1/3$ and $s \geq 4$. 





% Since $\alpha = (1-\epsilon)/2$, we have 
% $\epsilon = 1 - 2 \alpha, 1-\epsilon = 2\alpha, 1 + \epsilon = 2(1-\alpha)$, 
% $(5 - 3 \epsilon)/2 = 1 + 3\alpha$,  
% and 
% $$
%   \phi(\epsilon) 
%   = 3/2 \cdot (1+\epsilon)^{1/3} (1-\epsilon)^{2/3}
%   = 3\cdot ((1+\epsilon)/2)^{1/3} ((1-\epsilon)/2)^{2/3}
%   = 3 (1-\alpha)^{1/3} \alpha^{2/3}
%   \,.
% $$

% Setting $m(\epsilon, s)$ as the right-hand side of~\eqref{eq:grindign-praos-second-moment}, 
% we have
% \begin{equation*}%\label{eq:grindign-praos-second-moment}
%   m(\epsilon, s) 
%   = m(1 - 2\alpha, s) 
%   = s^2/2 
%   % \cdot  A(1 - 2 \alpha,2) 
%   \cdot \begin{cases}
%     % \left( 1 + 3\alpha \right)^s & \text{if}\quad 1/3 \leq \alpha < 1/2\,, \\
%     % \left( 2^{2/3} 3 (1-\alpha)^{1/3} \alpha^{2/3} \right)^s & \text{if}\quad 1/5 \leq \alpha < 1/3\,, \\
%     % \left( (5/3) 3 (1-\alpha)^{1/3} \alpha^{2/3} \right)^s & \text{if}\quad 0.905 \leq \alpha \leq 0.2\,, \\
%     % 1,  & \text{if}\quad 0 \leq \alpha < 0.905\,.
%     \left( 1 + 3\alpha \right)^s & \text{if}\quad 1/3 \leq \alpha < 1/2\,, \\
%     3^s \left( 4 \cdot (1-\alpha) \alpha^2 \right)^{s/3} & \text{if}\quad 1/5 \leq \alpha < 1/3\,, \\
%     5^s \left( (1-\alpha) \alpha^2 \right)^{s/3} & \text{if}\quad 0.905 \leq \alpha \leq 0.2\,, \\
%     1,  & \text{if}\quad 0 \leq \alpha < 0.905\,.
%   \end{cases}    
% \end{equation*}



\hfill\qed

The proofs of Claims~\ref{claim:multiple-honest-blocks},~\ref{claim:t1star-variance-exact}, 
and~\ref{claim:t2star-variance-exact} 
are given below in \Section~\ref{sec:praos-claim-multiple-honest-blocks},~\ref{sec:praos-claim-t1star-variance-exact}, and~\ref{sec:praos-claim-t2star-variance-exact}.




