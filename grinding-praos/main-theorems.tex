

\section{Praos beacon for a single epoch}
\begin{theorem}[Praos beacon, single epoch]\label{thm:minentropy-loss-praos-single-epoch}  
  Let $\epsilon \in (0,1)$. 
  Suppose Praos 
  remains $(\EpsP, k, s)$-secure 
  inside any epoch 
  whose characteristic string $W$ has the distribution $\mathcal{L}((1-\epsilon)/2)$. 
  Let $\rho$ be the min-entropy loss in 
  the beacon output, $\eta$, after an epoch. 
  Recall $\phi(\epsilon)$ from~\eqref{eq:phi_eps} 
  and $V(\epsilon)$ from~\eqref{eq:V-eps-praos}.
  Let 
  \begin{align}\label{eq:gamma-expression-praos}
    \gamma = \left( 0.4 (1+2\epsilon) \right)^{1/2} s \cdot V(\epsilon)^{1/2} \EpsP^{-1/2}
    \,.
  \end{align}
  Then $$
    \Pr_{W \sim \mathcal{L}((1-\epsilon)/2)}[g(n,\epsilon) > \gamma] \leq 2 \EpsP
  $$ 
  and, consequently, 
  $$
    \Pr_{W \sim \mathcal{L}((1-\epsilon)/2)}[\rho > 0.5 \log_2 \gamma ] \leq 2 \EpsP\,.
  $$
  In particular, for $\epsilon > 0.809$, 
  $g(n, \epsilon) = O(s)$ and $\rho = O(\log_2 s)$ 
  except with probability $2 \EpsP$.
\end{theorem}
\noindent
Note that if $\epsilon < 0.809$, 
$\rho = \Omega(s)$ 
except with probability $2 \EpsP$.


\iftoggle{drawfigs}{
  \input{grinding-praos/fig-praos-single-epoch}
}

% \section{Proof of Theorem~\ref{thm:minentropy-loss-praos-single-epoch}}
\begin{proof}  
  Let $\epsilon \in (0,1)$ and $\alpha = (1-\epsilon)/2$ be the adversarial stake.
  Suppose that $\Blockchain$ is $(\EpsP, k, s)$-secure in an epoch 
  where first $n$ slots, 
  which correspond to a characteristic string $W \sim \mathcal{L}_n(\alpha)$, 
  contribute to the beacon output.
  Recall $g(n,\epsilon)$ defined in ~\eqref{eq:praos-gneps}.
  Using Lemma~\ref{lemma:grinding-praos-second-moment} and~\ref{lemma:praos-tail-gamma}, 
  we can see that except with probability $2\EpsP$, $g(n,\epsilon)$ is at most $\sqrt{m/\EpsP}$ 
  where $m$ is the right-hand-side of~\eqref{eq:grinding-praos-second-moment}.
\end{proof}
% \hfill\qed









\section{Proof of Theorem~\ref{thm:minentropy-loss-praos-multi-epochs}}\label{sec:thm-praos-multiepoch}\label{sec:proof-praos-theorem}

Let $W \sim \mathcal{L}_n(\alpha)$. 
Let $E_p$ be the event that 
$\Blockchain$ is not $(\EpsP, k, s)$-secure during 
the first $n$ slots in an epoch. 
Let $M$ be an upper bound on the second moment of $g$, 
conditioned on $\overline{E}$. 
Let $\gamma \geq (M/\EpsP)^{1/2}$. 
Let $E_g$ be the event that $g(W)$ is more than $\gamma$.
By Lemma~\ref{lemma:grinding-praos-second-moment}, 
$\Pr[g(W) \geq \gamma] \leq 2 \EpsP$. 
Note that the min-entropy loss in the beacon is at most 
\begin{equation}\label{eq:log-gamma}
 \log_2(\gamma) 
 = 1/2 \cdot [\log_2(M) + \log_2(1/\EpsP)]
 = \log_2(\sqrt{M}) + \log_2(1/\sqrt{\EpsP})
 \,. 
\end{equation}


Condition on the event that neither $E_p$ nor $E_g$ 
occurs during the first $L$ epochs. 
This means, in any of the $L$ epochs, 
the adversary can inflate the failure probability 
by at most a factor of $\gamma$.
The total bad probability after $L$ epochs is
$$
  p
  \leq L (2 \EpsP + \gamma \EpsP)
  = L (2 \EpsP + M^{1/2} \sqrt{\EpsP})
  \,.
$$

Since $\epsilon > 0.809$, we refer to \eqref{eq:V-eps-praos} 
and the statement of the theorem immediately follows.

The only missing pieces are 
the proofs of Claims~\ref{claim:multiple-honest-blocks},~\ref{claim:t1star-variance-exact}, 
and~\ref{claim:t2star-variance-exact}; 
These are given in \Section~\ref{sec:praos-claim-multiple-honest-blocks},~\ref{sec:praos-claim-t1star-variance-exact}, and~\ref{sec:praos-claim-t2star-variance-exact}, respectively. 

\hfill\qed




