

\begin{figure}[!htb]
    \centering
    \begin{tikzpicture}[trim axis left,
      ]
      \begin{axis}[domain=0:1, 
        xmin=0,xmax=1,%,%ymin=-100%,ymax=2.5
        restrict x to domain=0.02:0.98,
        samples=500,
        enlarge x limits=false,
        grid=both,
        no markers, 
        % legend pos=outer north east,
        legend pos=north east,
        legend cell align=left,
        x label style={at={(axis description cs:0.5,-0.1)},anchor=north},
        % y label style={at={(axis description cs:-0.1,.5)},anchor=south},
        xlabel={$\epsilon$, honest bias},
        title={$\rho^*$, upper bound on the min-entropy loss $\rho$},
        ]
        \addplot +[ultra thick,red] { PraosMinEntropyLossMultiEpoch(\x, 1200, 2) };
        \addlegendentry{$k = 1200$};
        \addplot +[ultra thick,black] { PraosMinEntropyLossMultiEpoch(\x, 900, 2) };
        \addlegendentry{$k = 900$};
        \addplot +[ultra thick,blue] { PraosMinEntropyLossMultiEpoch(\x, 600, 2) };
        \addlegendentry{$k = 600$};
      \end{axis}
    \end{tikzpicture}%
    \begin{tikzpicture}[trim axis left,
      ]
      \begin{axis}[domain=0.6:1, 
        restrict x to domain=0.6:0.999,
        % restrict y to domain=0:100,
        samples=500,
        enlarge x limits=false,
        grid=both,
        no markers,
        % legend pos=outer north east,
        legend pos=north west,
        legend cell align=left,
        x label style={at={(axis description cs:0.5,-0.1)},anchor=north},
        y label style={at={(axis description cs:-0.1,.5)},anchor=south},
        xlabel={$\epsilon$, honest bias},
        title={$\log_2\, \Pr[ \rho > \rho^* ]$},
        xmin=0.6,xmax=1%,ymin=0%,ymax=2.5
        ]
        \addplot +[ultra thick,red] { LnPraosPrBadMultiEpoch(\x, 900, 2)/ln(2) } ;
        \addlegendentry{$L=2, k = 900$};
        \addplot +[ultra thick,black] {  LnPraosPrBadMultiEpoch(\x, 900, 2000)/ln(2)  };
        \addlegendentry{$L = 2000, k = 900$};
        \addplot +[ultra thick,blue] {  LnPraosPrBadMultiEpoch(\x, 900, 200000)/ln(2) };
        \addlegendentry{$L = 200000, k = 900$};
      \end{axis}
    \end{tikzpicture}
    \caption[Praos beacon]{
        (\textbf{Left}) The upper bound $\rho^*$ on $\rho)$, 
        Praos beacon's min-entropy loss (in bits) over $L$ epochs, 
        as a function of the honest bias, $\epsilon$. 
        Note that the loss does not depend on $L$ and that 
        it is zero for $\epsilon > 0.809$.
        The Praos protocol parameters are the same as in Fig~\ref{fig:praos-beacon-single-epoch}. 
        (\textbf{Right}) The probability that $\rho > \rho^*$; 
        this probability is zero when $\epsilon < 0.809$.
        Although the probability depends linearly on $L$, 
        the effect is dwarfed by the fast-decaying $\EpsP$. 
    }
    \label{fig:praos-beacon}
\end{figure}
