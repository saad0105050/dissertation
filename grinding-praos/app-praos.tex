%============================================

To set the stage, we record a simple upper bound on grinding power:
\begin{proposition}\label{prop:praos-moments-simple}
  Let $w \in \{0,1\}^n$. Then $g(w) \leq n 2^{\wt(w)}$, where $\wt(w)$ denotes the weight of $w$. If $W$ is distributed according to $B(n,(1 - \epsilon)/2)$ then
  \[
    \Exp[g(W)] \leq n \left(\frac{3 - \epsilon}{2}\right)^n \quad\text{and}\quad\Exp[g(W)^2] \leq n^2\left(\frac{5 - 3\epsilon}{2}\right)^n\,.
  \]
\end{proposition}

\begin{proof}
  Observe that
  \begin{align*}
    \Exp[g(W)] 
    &\leq n\Exp[2^{\wt{W}}] 
    = n\Exp[2^{\sum W_i}] 
    = n\Exp\left[\prod_i 2^{W_i}\right] 
    = n\prod_i \Exp[2^{W_i}] \\
    &= n \left( \frac{1-\epsilon}{2} \cdot 2 + \frac{1 + \epsilon}{2}\right)^n 
    = n \left(\frac{3 - \epsilon}{2}\right)^n\,.
  \end{align*}
    Similarly,
  \[
    \Exp[g(W)^2] \leq n^2 \Exp[2^{2\wt{W}}] = n^2\prod_i \Exp[2^{2W_i}] \leq n^2\left( \frac{1-\epsilon}{2} \cdot 4 + \frac{1 + \epsilon}{2}\right)^n = n \left(\frac{5 - 3\epsilon}{2}\right)^n\,.\qedhere
  \]
\end{proof}

To obtain more precise estimates, for a string $w \in \{0,1\}^*$ define
\[
  t(w) = \begin{cases}
    2^{\wt(w)} & \text{if $\wt(w) \geq |w|/2$\,,}\\
    0 & \text{if $\wt(w) < |w|/2$\,.}
  \end{cases}
\]
Then observe that
\begin{equation}\label{eq:g-decomposition}
  g(w) \leq \sum_{x\; \text{a suffix of $w$}} t(x)\,.
\end{equation}
Intuitively, the quantity $t(w_{n-d+1} \ldots w_n)$ reflects the grinding power of this ``tail'' of the string, equivalent to the number of option sequences for which $i_0 = n-d$ favorably assuming that $w_{n-d} = 0$.
\begin{proposition}\label{prop:moments-general}
  Let $W$ be distributed according to $B(d,(1 - \epsilon)/2)$. Then
  \[
    \Exp[g(W)] \leq \sum_{d = 0}^{n-1} \Exp[t(W_{n-d} \ldots W_n)] \quad \text{and}\quad \Exp[g(W)^2] \leq n \sum_{d = 0}^{n-1} \Exp[t(W_{n-d} \ldots W_n)^2]\,.
  \]
\end{proposition}

\begin{proof}
  The first inequality follows directly from~\eqref{eq:g-decomposition} and the linearity of
  expectation. As for the second inequality, note that if a random
  variable $X$ can be expressed as the sum $Y_1 + \cdots + Y_n$ then
  \[
    \Exp[X^2] = \sum_{ij} \Exp[Y_iY_j] \leq \sum_{ij} \sqrt{\Exp[Y_i^2] \Exp[Y_j^2]} = \left(\sum_i \sqrt{\Exp[Y_i^2]} \right)^2 \leq n \sum_i \Exp[Y_i^2]\,,
  \]
  where both of the inequalities follow from the Cauchy-Schwarz inequality.
  Applying this to the inequality~\eqref{eq:g-decomposition} completes the proof.
\end{proof}

\begin{proposition}\label{prop:moments-t-large-eps}
  Let $W$ be distributed according to $B(d,(1 - \epsilon)/2)$.
  \begin{itemize}
  \item For any $\epsilon \geq 1/3$, \quad $\displaystyle \Exp[t(W)] \leq \left(\sqrt{2(1 - \epsilon^2)}\right)^d\,.$
  \item For any $\epsilon \geq 3/5$, \quad $\displaystyle \Exp[t(W)^2] \leq \left(2\sqrt{1 - \epsilon^2}\right)^d\,.$
  \end{itemize}
  \end{proposition}

\begin{proof}
  Observe that for any $\alpha \geq 1$,
  \[
    \forall w\in \{0,1\}^n \qquad t(w) \leq 2^{(1 - \alpha)d/2 + \alpha\sum_i w_i}\,.
  \]
  It follows that
  \begin{align*}
    \Exp[ t(W) ] &\leq \min_{\alpha \geq 1} \Exp\left[2^{(1 - \alpha)d/2 + \alpha\sum_i W_i}\right] = \min_{\alpha \geq 1} 2^{-(\alpha - 1)d/2} \Exp\left[2^{\alpha\sum_i W_i}\right]\\
                 &= \min_{\alpha \geq 1} 2^{-(\alpha - 1)d/2} \prod_i \Exp\left[2^{\alpha W_i}\right] = \min_{\alpha \geq 1} 2^{-(\alpha - 1)d/2} \prod_i \left[\left(\frac{1+\epsilon}{2}\right) + \left(\frac{1-\epsilon}{2}\right) 2^{\alpha}\right]\\
  &= \min_{\alpha \geq 1} \left(2^{-(\alpha - 1)/2} \left[\left(\frac{1+\epsilon}{2}\right) + \left(\frac{1-\epsilon}{2}\right) 2^{\alpha}\right]\right)^d \\
  &= \min_{\alpha \geq 1} \left(2^{-1/2} \left[(1+\epsilon)2^{-\alpha/2}  + (1-\epsilon) 2^{\alpha/2}\right]\right)^d\,.
\end{align*}
Considering the quantity
$\beta(a) = (1 - \epsilon) a + (1 + \epsilon) a^{-1}$, note that
\[
  \frac{d\beta(a)}{da} = (1 - \epsilon) - \frac{1 + \epsilon}{a^2}
\]
and hence that $\beta(a)$ is minimized at
\[
  a^*_\epsilon = \sqrt{\frac{1 + \epsilon}{1 - \epsilon}}\,.
\]
Thus the minimum value of $\beta(a)$ is
$2\sqrt{(1 + \epsilon)(1 - \epsilon)}$. When $\epsilon \geq 1/3$, we find that $a_\epsilon^* \geq \sqrt{2}$ which corresponds to a value of $\alpha \geq 1$ above. In this case, 
\[
  \Exp[t(W)] \leq \left( \sqrt{2(1 - \epsilon^2)}\right)^d\,.
\]
The second moment estimate follows from an analogous computation, so
we are more brief. In this case,
  \begin{align*}
    \Exp[ t(W)^2 ] &\leq \min_{\alpha \geq 1} \Exp\left[2^{(1 - \alpha)d + 2\alpha\sum_i W_i}\right] = \min_{\alpha \geq 1} 2^{-(\alpha - 1)d} \prod_i \Exp\left[2^{2\alpha W_i}\right]\\
    &= \min_{\alpha \geq 1} 2^{-(\alpha - 1)d} \prod_i \left[\left(\frac{1+\epsilon}{2}\right) + \left(\frac{1-\epsilon}{2}\right) 2^{2\alpha}\right] = \left(\min_{\alpha \geq 1} \left[(1+\epsilon)2^{-\alpha}  + (1-\epsilon) 2^{\alpha}\right]\right)^d\,.
\end{align*}
As above, this is minimized when $2^\alpha = \sqrt{(1 + \epsilon)/(1 - \epsilon)}$. When $\epsilon \geq 3/5$, the corresponding value of $\alpha$ exceeds $1$ and we conclude that
\[
  \Exp[t(W)^2] \leq \left(2\sqrt{(1 + \epsilon)(1 - \epsilon)}\right)^d\,,
\]
as desired.
\end{proof}

Combining these estimates with Proposition~\ref{prop:moments-general}, we obtain estimates for the first and second moments of $g(W)$. 
\begin{corollary}
  Let $W$ be a random variable distributed according to $B(n,(1-\epsilon)/2)$.
  \begin{itemize}
  \item For any $\epsilon \geq 1/3$, \quad $\displaystyle \Exp[g(W)] \leq \sum_{d=1}^n \left(\sqrt{2(1 - \epsilon^2)}\right)^d\,.$
  \item For any $\epsilon \geq 3/5$, \quad $\displaystyle
    \Exp[g(W)^2] \leq n \sum_{d=1}^n \left(2\sqrt{(1 - \epsilon^2)}\right)^d\,.$
  \end{itemize}
\end{corollary}


These geometric series lead to immediate bounds. 

\begin{proposition}\label{prop:praos-moments-simple-large-eps} 
  Let $W$ be a random variable distributed according to $B(n,(1-\epsilon)/2)$.
    \begin{itemize}
    \item For any $\epsilon > 1/\sqrt{2}$, \quad
      $\displaystyle
        \Exp[g(W)] \leq \frac{1}{1 - \sqrt{2(1 - \epsilon^2)}}\,.$
    \item For any $\epsilon > \sqrt{3}/2$, \quad $\displaystyle \Exp[g(W)^2] \leq \frac{n}{1 - 2\sqrt{(1 - \epsilon^2)}}\,.$
    \end{itemize}
\end{proposition}

\begin{proof}
  Recall that for $c < 1$, $\sum_{t = 0}^T c^t \leq \sum_{t \geq 0} c^t = 1/(1 - c)$.
\end{proof}





%===========================================================

