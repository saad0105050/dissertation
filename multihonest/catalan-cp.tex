    

% \subsection{UVP}

% Next, we characterize the \emph{Catalan slots}. 
% Their importace lies in the following: 
% A Catalan slot $c$ acts as a barrier for adversarial tine extensions 
% in that in any fork, every tine viable at the onset of slot $c+1$ must be honest. 
% In addition, if an honest slot has the bottleneck property then it must be Catalan. 


Below, we define the so-called Catalan slots and show, 
in Theorems~\ref{thm:unique-honest} and~\ref{thm:multiple-honest}, 
that certain Catalan slots have the UVP.

\section{Catalan Slots}\label{sec:catalan}

\begin{definition}[Catalan slot]
  Let $w \in \{\h, \H, \A\}^T$ be a characteristic string and 
  let $s \in [T]$ be an integer. 
  $s$ is called a \emph{left-Catalan slot in $w$} 
  if, for any integer $\ell \in [s]$, the interval $[\ell, s]$ is $\Hheavy$ in $w$.
  $s$ is called a \emph{right-Catalan slot in $w$} 
  if, for any integer $r \in [s, T]$, the interval $[s, r]$ is $\Hheavy$ in $w$.
  Finally, $s$ is called a \emph{Catalan slot in $w$} if 
  it is both left- and right-Catalan in $w$. 
\end{definition}
Observe that a left- or right-Catalan slot must be honest. 
In addition, the slot before a left-Catalan 
(resp., after a right-Catalan) slot must be honest as well.
Thus the slots adjacent to a Catalan slot must be honest. 
A Catalan slot $c$ acts as a barrier for adversarial tine extensions 
in that in any fork, every tine viable at the onset of slot $c+1$ must be honest. 


\begin{fact}\label{fact:catalan-unique-longest}
  Let $w \in \{\h, \H, \A\}^T$ be a characteristic string 
  and $s$ a left-Catalan slot in $w$. 
  In any fork for $w$, 
  every viable tine at the onset of slot $s + 1$ is 
  an honest tine from slot $s$. 
\end{fact}
\begin{proof}
  % Note that a left-Catalan slot is honest and 
  Let $\tau$ be the longest tine with label $s$. 
  ($\tau$ is an honest tine. 
  If $s$ is a uniquely honest slot, 
  $\tau$ is unique. Otherwise, 
  $\tau$ is unique up to tie-breaking among equally-long tines.)
  We claim that 
  all adversarial tines $t \in F, \ell(t) \leq s - 1$ 
  are strictly shorter than $\tau$.
  Suppose, towards a contradiction, that 
  $t$ is a viable adversarial tine at the onset of slot $s + 1$, i.e., 
  $\ell(t) \leq s - 1$ and $\length(t) \geq \length(\tau)$. 
  Let $B$ be the last honest vertex on $t$; necessarily, $\ell(B) < s$. 
  According to 
  Proposition~\ref{prop:fork-structure},
  the interval $[\ell(B) + 1, s]$ is $\Aheavy$. 
  But this contradicts the assumption that $s$ is a left-Catalan slot. 
  Hence the adversarial tine $t$ cannot be viable.
\end{proof}


\begin{observation}\label{obs:multi-honest}
  If $s$ is a Catalan slot for $w$, Fact~\ref{fact:catalan-unique-longest} implies that 
  in every fork for $w$, 
  an honest slot leader at slot $s + 1$ always 
  builds on top of an honest tine with label $s$; 
  this tine, in fact, will have the maximum length among all tines with label $s$.
\end{observation}



\begin{fact}\label{fact:almost-cp-implies-catalan}
  Let $w \in \{\h, \H, \A\}^T$ be a characteristic string. 
  If an honest slot in $w$ has the bottleneck property then 
  it is a Catalan slot.
\end{fact}
\begin{proof}
  Let $s \in [T]$ be an honest slot in $w$.  
  We will prove the contrapositive: namely, 
  that if $s$ is not Catalan then $s$ does not have the bottleneck property. 
  
  Suppose $s$ is not a Catalan slot.
  Then there must be some $a, b \in [T]$ so that 
  $I = [a, b]$ is the largest $\Aheavy$ interval 
  which includes $s$. 
  Necessarily, either $b = T$, or $b + 1$ must be an honest slot. 
  Likewise, either $a = 1$, or $a - 1$ must be an honest slot. 
  
  Let $F$ be a fork for $w_1 \ldots w_b$ 
  and let $u \in F, \ell(u) = a - 1$ be an honest tine. 
  (If $a = 1$, we can take $u$ as the root vertex.)  
  Let $t$ be a maximum-length honest tine in $F$ 
  and assume that $\length(t) = \length(u) + \#_\h(I) + \#_\H(I)$.
  Since $I$ is $\Aheavy$, 
  Proposition~\ref{prop:fork-structure} 
  states that 
  it is possible to augment $u$ into 
  an adversarial extension $t'$ 
  viable at the onset of slot $b + 1$. 
  As $t'$ will not contain any vertex from the honest slot $s$,  
  $s$ does not have the bottleneck property in $w$.
\end{proof}


\section{A uniquely honest Catalan slot has the UVP}

The following theorem shows that a uniquely honest Catalan slot has the UVP.
% \subsection{UVP from a uniquely honest Catalan slot}


  % Given a Boolean characteristic string $w$, written as $w = xy$,
  % an \emph{$x$-balanced fork} is a fork where there are 
  % two maximally long (viable) tines that are disjoint over the suffix $y$. 
  % Let $w$ be a characteristic string for which 
  % there is an $x$-balanced fork for some decomposition $w = xy$. 
  % Then, in fact, there must be a shortest prefix $x' \Prefix w$ so that 
  % $w = x'y'$ admits an $x'$-balanced fork; 
  % we call this fork the \emph{deepest balanced fork for $w$}. 
  % If there is an $x$-balanced fork with $|x| = 0$, we say that \emph{$w$ is forkable.}



  \begin{theorem}\label{thm:unique-honest}
    Let $w \in \{h,H,A\}^T$ be a characteristic string. 
    Let $s \in [T]$ be a uniquely honest slot in $w$. 
    Slot $s$ is Catalan in $w$ 
    if and only if 
    it has the UVP in $w$. 
  \end{theorem}

  \begin{proof}
    (The reverse implication.) 
    % This is easy. 
    Since $s$ has the UVP  
    it satisfies the (weaker) bottleneck property. 
    By Fact~\ref{fact:almost-cp-implies-catalan}, 
    the honest slot $s$ must be Catalan. 

    (The forward implication.) 
    By assumption, slot $s$ has a unique honest leader. 
    Let $\tau$ be the unique honest tine at slot $s$.
    By Fact~\ref{fact:catalan-unique-longest}, 
    the honest tine $\tau$ is the only viable tine 
    at the onset of slot $s + 1$.    
    If $s = T$ then $\tau$ is the only viable tine 
    at the onset of slot $T + 1$.
    Now suppose $s \leq T - 1$.
    As $s$ is a Catalan slot, slots $s$ and $s + 1$ must be honest. 
    Let $t$ be a viable tine at the onset of some slot $k, k \geq s + 2$. 
    We claim that $\tau$ must be a prefix of $t$. 

    Suppose, for a contradiction, that $t$ does not contain $\tau$ as
    its prefix.  Let $B_1$ be the last honest vertex on $t$ such that
    $\ell(B_1) \leq s - 1$.  (If $s = 1$ or no such vertex can be
    found, take $B_1$ as the root vertex.)  Likewise, let $B_2$ be the
    first honest vertex, if it exists, on $t$ such that
    $\ell(B_2) \in [s + 1, k - 1]$.


    Suppose $B_2$ exists.  If $\ell(B_2) = s + 1$ then, by
    Observation~\ref{obs:multi-honest}, $B_2$ builds on $\tau$,
    contradicting our assumption that $\tau$ is not a prefix of $t$.
    Otherwise, suppose $\ell(B_2) \in [s + 2, k-1]$.  Let $I$ be the
    interval $[\ell(B_1) + 1, \ell(B_2) - 1]$.  Clearly, $I$ contains
    $s$.  If $t$ contains any adversarial vertex between $B_1$ and
    $B_2$ then, by Corollary~\ref{coro:interval-honest-vertices}, $I$
    must be $\Aheavy$; but this contradicts the assumption that $s$ is
    a Catalan slot.  Otherwise, $B_2$ builds on top of $B_1$ and, in
    particular, $B_1$ must be viable at the onset of slot
    $\ell(B_2) \geq s + 1$.  Since $\ell(\tau) = s$, this means
    $\length(B_1) \geq \length(\tau)$.  However, since
    $\ell(B_1) < s$, by the monotonicity of the honest-depth function
    $\hdepth(\cdot)$, $\length(\tau) \geq 1 + \length(B_1)$.  This
    contradicts the inequality above.


    Now suppose $B_2$ does not exist.  We claim that $t$ is an
    adversarial tine.  To see why, note that if $t$ were honest and
    $\ell(t) \geq s + 1$ then there would have been a $B_2$.  Since
    $s$ is a uniquely honest slot and $\tau$ is not a prefix of $t$ by
    assumption, $\ell(t) \neq s$ if $t$ is honest.

    
    Finally, if $t$ is honest and $\ell(t) \leq s - 1$ then, 
    by Fact~\ref{fact:catalan-unique-longest}, 
    $t$ cannot be viable at the onset of slot $s + 1$ 
    since $s$ is Catalan. 
    Since $s + 1$ is an honest slot, 
    honest tines with label $s + 1$ will be strictly longer than $t$ 
    and, therefore, 
    $t$ cannot be viable at the onset of slot $k \geq s + 2$ either. 
    We conclude that $t$ must be an adversarial tine viable at the onset of slot $k$. 
    By Proposition~\ref{prop:fork-structure},       
    the interval $I = [\ell(B_1) + 1, k - 1]$ must be $\Aheavy$. 
    However, since $I$ contains $s$, it contradicts the fact that $s$ is a Catalan slot. 

    It follows that every viable tine 
    $t \in F, \ell(t) \geq s + 1$ must contain $\tau$ as its prefix. 
  \end{proof}



